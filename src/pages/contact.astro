---
import PageLayout from '../layouts/PageLayout.astro';
import ContactForm from '../components/vue/ContactForm.vue';
import SocialLinks from '../components/astro/SocialLinks.astro';
import ObfuscatedEmail from '../components/astro/ObfuscatedEmail.astro';
import { getSiteConfig, getSiteName, isPersonalMode } from '../lib/config';

const config = getSiteConfig();
const siteName = getSiteName();
const personal = isPersonalMode();
const web3formsKey = config.web3forms?.accessKey;
---

<PageLayout title="Contact" description={personal ? 'Get in touch.' : 'Get in touch with our research lab.'}>
  <h1 class="mb-2 font-serif text-2xl font-normal text-surface-900 sm:text-3xl dark:text-dm-heading">Contact Us</h1>
  <p class="mb-8 text-sm text-surface-500 dark:text-dm-muted">
    Have questions about our research or interested in collaboration? Get in touch.
  </p>

  <div class="grid gap-8 lg:grid-cols-[1fr_280px]">
    <!-- Contact Form -->
    <div>
      <h2
        class="mb-4 border-b border-surface-200 pb-2 font-serif text-lg font-normal text-surface-900 dark:border-dm-border dark:text-dm-heading"
      >
        Send a Message
      </h2>
      {
        web3formsKey ? (
          <ContactForm client:visible accessKey={web3formsKey} />
        ) : (
          <p class="text-sm text-surface-500 dark:text-dm-muted">
            Get in touch via email:{' '}
            <ObfuscatedEmail
              email={config.socials.email!}
              class="text-primary-600 hover:underline dark:text-accent-400"
            />
          </p>
        )
      }
    </div>

    <!-- Contact Info -->
    <div class="space-y-6">
      <div>
        <h3 class="mb-2 text-sm font-medium text-surface-900 dark:text-dm-heading">
          {personal ? 'Contact Information' : 'Lab Information'}
        </h3>
        <div class="space-y-2 text-sm text-surface-500 dark:text-dm-muted">
          <div>
            <span class="text-surface-900 dark:text-dm-heading">{siteName}</span><br />
            {config.department}<br />
            {config.university}
          </div>
          <div>
            <span class="text-surface-700 dark:text-dm-text">Email:</span><br />
            <ObfuscatedEmail
              email={config.socials.email!}
              class="text-primary-600 hover:underline dark:text-accent-400"
            />
          </div>
          <div>
            <span class="text-surface-700 dark:text-dm-text">Address:</span><br />
            Room 123, CS Building<br />
            123 University Ave<br />
            City, State 12345
          </div>
        </div>
      </div>

      <div class="border-t border-surface-200 pt-4 dark:border-dm-border">
        <h3 class="mb-2 text-sm font-medium text-surface-900 dark:text-dm-heading">Follow Us</h3>
        <SocialLinks socials={config.socials} />
      </div>
    </div>
  </div>
</PageLayout>

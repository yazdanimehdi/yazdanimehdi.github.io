---
interface Props {
  socials: Record<string, string | undefined>;
  size?: 'sm' | 'md';
  inline?: boolean;
}

const { socials, size = 'md', inline = false } = Astro.props;
const iconSize = size === 'sm' ? 'w-4 h-4' : 'w-[18px] h-[18px]';

const socialIcons: Record<string, { label: string; icon: string; filled?: boolean }> = {
  email: {
    label: 'Email',
    icon: '<path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />',
  },
  scholar: {
    label: 'Google Scholar',
    icon: '<path d="M5.242 13.769L0 9.5 12 0l12 9.5-5.242 4.269C17.548 11.249 14.978 9.5 12 9.5c-2.977 0-5.548 1.748-6.758 4.269zM12 10a7 7 0 100 14 7 7 0 000-14z" />',
    filled: true,
  },
  github: {
    label: 'GitHub',
    icon: '<path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0024 12c0-6.63-5.37-12-12-12z" />',
    filled: true,
  },
  twitter: {
    label: 'Twitter/X',
    icon: '<path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />',
    filled: true,
  },
  linkedin: {
    label: 'LinkedIn',
    icon: '<path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />',
    filled: true,
  },
  orcid: {
    label: 'ORCID',
    icon: '<path d="M12 0C5.372 0 0 5.372 0 12s5.372 12 12 12 12-5.372 12-12S18.628 0 12 0zM7.369 4.378c.525 0 .947.431.947.947s-.422.947-.947.947a.95.95 0 01-.947-.947c0-.525.422-.947.947-.947zm-.722 3.038h1.444v10.041H6.647V7.416zm3.562 0h3.9c3.712 0 5.344 2.653 5.344 5.025 0 2.578-2.016 5.025-5.325 5.025h-3.919V7.416zm1.444 1.303v7.444h2.297c3.272 0 4.022-2.484 4.022-3.722 0-2.016-1.284-3.722-3.919-3.722h-2.4z" />',
    filled: true,
  },
  bluesky: {
    label: 'Bluesky',
    icon: '<path d="M5.202 2.857C7.954 4.922 10.913 9.11 12 11.358c1.087-2.247 4.046-6.436 6.798-8.501C20.783 1.366 24 .213 24 3.883c0 .732-.42 6.156-.667 7.037-.856 3.061-3.978 3.842-6.755 3.37 4.854.826 6.089 3.562 3.422 6.299-5.065 5.196-7.28-1.304-7.847-2.97-.104-.305-.152-.448-.153-.327 0-.121-.05.022-.153.327-.568 1.666-2.782 8.166-7.847 2.97-2.667-2.737-1.432-5.473 3.422-6.3-2.777.473-5.899-.308-6.755-3.369C.42 10.04 0 4.615 0 3.883c0-3.67 3.217-2.517 5.202-1.026" />',
    filled: true,
  },
  mastodon: {
    label: 'Mastodon',
    icon: '<path d="M23.268 5.313c-.35-2.578-2.617-4.61-5.304-5.004C17.51.242 15.792 0 11.813 0h-.03c-3.98 0-4.835.242-5.288.309C3.882.692 1.496 2.518.917 5.127.64 6.412.61 7.837.661 9.143c.074 1.874.088 3.745.26 5.611.118 1.24.325 2.47.62 3.68.55 2.237 2.777 4.098 4.96 4.857 2.336.792 4.849.923 7.256.38.265-.061.527-.132.786-.213.585-.184 1.27-.39 1.774-.753a.057.057 0 00.023-.043v-1.809a.052.052 0 00-.02-.041.053.053 0 00-.046-.01 20.282 20.282 0 01-4.709.547c-2.73 0-3.463-1.284-3.674-1.818a5.593 5.593 0 01-.319-1.433.053.053 0 01.066-.054 19.648 19.648 0 004.581.536h.344c1.587 0 3.176-.088 4.748-.345 .043-.007.084-.017.124-.027 2.394-.455 4.673-1.88 4.907-5.56.009-.154.024-1.593.024-1.753 0-.536.157-3.804-.205-5.812zM19.69 13.27h-2.448v-5.63c0-1.186-.498-1.789-1.495-1.789-1.102 0-1.654.714-1.654 2.127v3.078h-2.434v-3.078c0-1.413-.552-2.127-1.655-2.127-.997 0-1.495.603-1.495 1.789v5.63H6.06V7.448c0-1.185.303-2.127.91-2.825.625-.698 1.444-1.056 2.461-1.056 1.177 0 2.069.452 2.664 1.357l.574.963.573-.963c.596-.905 1.488-1.357 2.665-1.357 1.016 0 1.836.358 2.46 1.056.608.698.911 1.64.911 2.825v5.822h-.589z" />',
    filled: true,
  },
  website: {
    label: 'Website',
    icon: '<path d="M12 21a9.004 9.004 0 008.716-6.747M12 21a9.004 9.004 0 01-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 017.843 4.582M12 3a8.997 8.997 0 00-7.843 4.582m15.686 0A11.953 11.953 0 0112 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0121 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0112 16.5a17.92 17.92 0 01-8.716-2.247m0 0A9 9 0 013 12c0-1.47.353-2.856.978-4.082" />',
  },
};

function getHref(key: string, value: string): string {
  if (key === 'email') return `mailto:${value}`;
  return value;
}
---

<div class:list={['flex items-center gap-1', inline && 'inline-flex']}>
  {
    Object.entries(socials).map(([key, value]) => {
      if (!value || !socialIcons[key]) return null;
      const social = socialIcons[key];
      return (
        <a
          href={getHref(key, value)}
          target={key === 'email' ? undefined : '_blank'}
          rel={key === 'mastodon' ? 'me noopener noreferrer' : key === 'email' ? undefined : 'noopener noreferrer'}
          class="inline-flex items-center justify-center p-2 text-surface-500 transition-colors hover:text-primary-600 dark:text-dm-muted dark:hover:text-accent-400"
          title={social.label}
          aria-label={social.label}
        >
          <svg
            class={iconSize}
            fill={social.filled ? 'currentColor' : 'none'}
            viewBox="0 0 24 24"
            stroke={social.filled ? 'none' : 'currentColor'}
            stroke-width={social.filled ? '0' : '2'}
            set:html={social.icon}
          />
        </a>
      );
    })
  }
</div>
